import{_ as v,c as I,A as u,E as V,a as w}from"./index.7f3d917a.js";import"vue";const C={components:{CircleCheckFilled:I},props:["data"],data(){return{previewDialog:!1,dialogImageUrl:"",editFlag:!1,authorId:"",albumName:"",images:[],originalImg:[],endmsg:"\u4E0B\u62C9\u52A0\u8F7D\u66F4\u591A...",queryData:{authorId:"",albumName:"",startPage:0,pageSize:4},selectedImage:[],selectAllFlag:!0}},methods:{previewImage(e){this.dialogImageUrl=e,this.previewDialog=!0},handleScroll(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{let e=document.documentElement.scrollTop,t=document.documentElement.clientHeight,o=document.documentElement.scrollHeight;t+e-o>-10&&(this.endmsg="\u6B63\u5728\u52A0\u8F7D...",u.get("init/getImagesByAlbum",this.queryData).then(s=>{s.code==200&&(s.data.forEach(l=>{l.ok=!1,l.simplifyImg=this.baseUrl+l.simplifyImg,l.originalImg=this.baseUrl+l.originalImg,this.images.push(l),this.originalImg.push(l.originalImg)}),setTimeout(()=>{let l=this.images.length,a=l-s.data.length;for(a;a<l;a++)this.images[a].ok=!0},100),s.data.length<this.queryData.pageSize&&(this.endmsg="\u6CA1\u6709\u66F4\u591A\u4E86...",window.removeEventListener("scroll",this.handleScroll))),this.queryData.startPage=this.queryData.startPage+8}))},100)},management(){this.selectedImage=[],this.editFlag=!this.editFlag,this.images.forEach(e=>{e.select=!1})},selectImage(e){e.select=!e.select,e.select?this.selectedImage.push(e.id):this.selectedImage.forEach((t,o)=>{if(t.id==e.id){this.selectedImage.splice(o,1);return}})},moveImage(){},deleteImage(){if(this.selectedImage.length==0){V({showClose:!0,message:"\u8BF7\u9009\u62E9\u56FE\u7247",type:"warning"});return}w.confirm("\u786E\u8BA4\u5220\u9664?","\u63D0\u793A\u6846",{distinguishCancelAndClose:!0,confirmButtonText:"\u662F",cancelButtonText:"\u5426",type:"warning",customStyle:{top:"-20% !important",position:"relative"}}).then(()=>{u.post("image/delete",this.selectedImage).then(e=>{e.code==200&&(this.selectedImage.forEach(t=>{this.images.forEach((o,s)=>{if(o.id==t){this.images.splice(s,1);return}})}),V({showClose:!0,message:e.message,type:"success"}))})}).catch(e=>{})},selectAll(){this.selectedImage=[],this.selectAllFlag?this.images.forEach(e=>{e.select=!0,this.selectedImage.push(e.id)}):this.images.forEach(e=>{e.select=!1}),this.selectAllFlag=!this.selectAllFlag}},computed:{showFlag(){return!!(this.$store.state.isLogin&&this.authorId==this.$store.state.author.username)},coverImg(){let e=this.$store.state.albums,t=e.length;for(let o=0;o<t;o++)if(this.albumName==e[o].albumName)return e[o].coverImg}},watch:{},mounted(){window.addEventListener("scroll",this.handleScroll),this.authorId=this.data.split("_")[0],this.albumName=this.data.split("_")[1],this.queryData.authorId=this.authorId,this.queryData.albumName=this.albumName,u.get("init/getImagesByAlbum",this.queryData).then(e=>{e.code==200&&(e.data.forEach(t=>{t.ok=!1,t.simplifyImg=this.baseUrl+t.simplifyImg,t.originalImg=this.baseUrl+t.originalImg,this.images.push(t),this.originalImg.push(t.originalImg)}),setTimeout(()=>{let t=this.images.length,o=t-e.data.length;for(o;o<t;o++)this.images[o].ok=!0},100),e.data.length<this.queryData.pageSize&&(this.endmsg="\u6CA1\u6709\u66F4\u591A\u4E86...",window.removeEventListener("scroll",this.handleScroll)),this.queryData.startPage=this.queryData.startPage+4,this.queryData.pageSize=8)})},unmounted(){window.removeEventListener("scroll",this.handleScroll)}},y=e=>(Vue.pushScopeId("data-v-42000ab5"),e=e(),Vue.popScopeId(),e),N={class:"illustration"},k={class:"ArticleInfo"},x={style:{margin:"20px",color:"rgb(9, 214, 180)","font-size":"100px"}},E=y(()=>Vue.createElementVNode("span",{style:{color:"#06a0e9","font-size":"30px"}}," \u76F8\u518C ",-1)),b={style:{margin:"0 0 1% 2.5%",height:"30px",opacity:"0.7"}},D={key:0,style:{margin:"0 0 1% 1%",height:"30px",opacity:"0.7"}},S=["onClick"],F=["onClick"],T={class:"endmsg"},A={class:"previewbox"},B=["src"];function q(e,t,o,s,l,a){const m=Vue.resolveComponent("el-image"),p=Vue.resolveComponent("router-link"),n=Vue.resolveComponent("el-col"),c=Vue.resolveComponent("el-button"),r=Vue.resolveComponent("el-row"),d=Vue.resolveComponent("CircleCheckFilled"),h=Vue.resolveComponent("el-icon"),_=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.Transition,{name:"el-fade-in"},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",N,[Vue.createVNode(m,{fit:"cover",class:"img",src:a.coverImg,alt:"",lazy:""},null,8,["src"]),Vue.createElementVNode("div",k,[Vue.createElementVNode("h1",x,Vue.toDisplayString(l.albumName),1),Vue.createVNode(p,{to:"/Album/"+l.authorId},{default:Vue.withCtx(()=>[E]),_:1},8,["to"])])])]),_:1}),Vue.createVNode(r,{style:{"margin-top":"30px"}},{default:Vue.withCtx(()=>[Vue.createVNode(n,{class:"space"}),Vue.createVNode(n,{class:"container"},{default:Vue.withCtx(()=>[Vue.createVNode(r,null,{default:Vue.withCtx(()=>[Vue.createElementVNode("div",b,[a.showFlag?(Vue.openBlock(),Vue.createBlock(c,{key:0,type:"primary",onClick:a.management},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u7BA1\u7406")]),_:1},8,["onClick"])):Vue.createCommentVNode("",!0)]),Vue.createVNode(Vue.Transition,{name:"el-zoom-in-top"},{default:Vue.withCtx(()=>[l.editFlag?(Vue.openBlock(),Vue.createElementBlock("div",D,[Vue.createVNode(c,{type:"warning",onClick:a.moveImage},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u79FB\u52A8")]),_:1},8,["onClick"]),Vue.createVNode(c,{type:"danger",onClick:a.deleteImage},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u5220\u9664")]),_:1},8,["onClick"]),Vue.createVNode(c,{type:"success",onClick:a.selectAll},{default:Vue.withCtx(()=>[Vue.createTextVNode("\u5168\u9009")]),_:1},8,["onClick"])])):Vue.createCommentVNode("",!0)]),_:1})]),_:1}),Vue.createVNode(r,{class:"body"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(l.images,(i,f)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"item",key:f},[Vue.withDirectives(Vue.createElementVNode("div",{onClick:g=>a.selectImage(i)},[Vue.withDirectives(Vue.createVNode(h,{class:"selectIcon"},{default:Vue.withCtx(()=>[Vue.createVNode(d)]),_:2},1536),[[Vue.vShow,!i.select]]),Vue.withDirectives(Vue.createVNode(h,{class:"selectIcon1"},{default:Vue.withCtx(()=>[Vue.createVNode(d)]),_:2},1536),[[Vue.vShow,i.select]])],8,S),[[Vue.vShow,l.editFlag]]),Vue.createVNode(Vue.Transition,{name:"el-zoom-in-top"},{default:Vue.withCtx(()=>[Vue.withDirectives(Vue.createElementVNode("div",{class:"photoCloak",onClick:g=>a.selectImage(i)},null,8,F),[[Vue.vShow,l.editFlag]])]),_:2},1024),Vue.createVNode(Vue.Transition,{name:"el-zoom-in-top"},{default:Vue.withCtx(()=>[Vue.withDirectives(Vue.createVNode(m,{class:"photo",src:i.simplifyImg,fit:"cover",onClick:g=>a.previewImage(i.originalImg)},null,8,["src","onClick"]),[[Vue.vShow,i.ok]])]),_:2},1024)]))),128))]),_:1})]),_:1}),Vue.createVNode(n,{class:"space"})]),_:1}),Vue.createElementVNode("div",T,Vue.toDisplayString(l.endmsg),1),Vue.createVNode(_,{modelValue:l.previewDialog,"onUpdate:modelValue":t[0]||(t[0]=i=>l.previewDialog=i),width:"70%",top:"60px","append-to-body":!0,style:{"background-color":"aliceblue"}},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",A,[Vue.createElementVNode("img",{class:"img",src:l.dialogImageUrl},null,8,B)])]),_:1},8,["modelValue"])])}const L=v(C,[["render",q],["__scopeId","data-v-42000ab5"]]);export{L as default};
