import{_ as q,c as B,A as v,E as b,a as N,r as D,b as T,d as z,o as m,e as u,f as t,w as i,T as _,g as c,t as A,h as L,i as p,j as F,F as P,k as V,l as h,v as d,p as H,m as R}from"./index.f39f917a.js";/* empty css                */import{E as M,a as U,b as O}from"./el-image-viewer.041a35b8.js";const f={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}.VITE_BASE_URL,j={components:{CircleCheckFilled:B},props:["data"],data(){return{editFlag:!1,authorId:"",albumName:"",images:[],originalImg:[],endmsg:"\u4E0B\u62C9\u52A0\u8F7D\u66F4\u591A...",queryData:{authorId:"",albumName:"",startPage:0,pageSize:4},selectedImage:[],selectAllFlag:!0}},methods:{handleScroll(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{let e=document.documentElement.scrollTop,s=document.documentElement.clientHeight,a=document.documentElement.scrollHeight;s+e-a>-10&&(this.endmsg="\u6B63\u5728\u52A0\u8F7D...",v.get("init/getImagesByAlbum",this.queryData).then(n=>{n.code==200&&(n.data.forEach(l=>{l.ok=!1,l.simplifyImg=f+l.simplifyImg,this.images.push(l),this.originalImg.push(f+l.originalImg)}),setTimeout(()=>{let l=this.images.length,o=l-n.data.length;for(o;o<l;o++)this.images[o].ok=!0},100),n.data.length<this.queryData.pageSize&&(this.endmsg="\u6CA1\u6709\u66F4\u591A\u4E86...",window.removeEventListener("scroll",this.handleScroll))),this.queryData.startPage=this.queryData.startPage+8}))},100)},management(){this.selectedImage=[],this.editFlag=!this.editFlag,this.images.forEach(e=>{e.select=!1})},selectImage(e){e.select=!e.select,e.select?this.selectedImage.push(e.id):this.selectedImage.forEach((s,a)=>{if(s.id==e.id){this.selectedImage.splice(a,1);return}})},moveImage(){},deleteImage(){if(this.selectedImage.length==0){b({showClose:!0,message:"\u8BF7\u9009\u62E9\u56FE\u7247",type:"warning"});return}N.confirm("\u786E\u8BA4\u5220\u9664?","\u63D0\u793A\u6846",{distinguishCancelAndClose:!0,confirmButtonText:"\u662F",cancelButtonText:"\u5426",type:"warning",customStyle:{top:"-20% !important",position:"relative"}}).then(()=>{v.post("image/delete",this.selectedImage).then(e=>{e.code==200&&(this.selectedImage.forEach(s=>{this.images.forEach((a,n)=>{if(a.id==s){this.images.splice(n,1);return}})}),b({showClose:!0,message:e.message,type:"success"}))})}).catch(e=>{})},selectAll(){this.selectedImage=[],this.selectAllFlag?this.images.forEach(e=>{e.select=!0,this.selectedImage.push(e.id)}):this.images.forEach(e=>{e.select=!1}),this.selectAllFlag=!this.selectAllFlag}},computed:{showFlag(){return!!(this.$store.state.isLogin&&this.authorId==this.$store.state.author.username)},coverImg(){let e=this.$store.state.albums,s=e.length;for(let a=0;a<s;a++)if(this.albumName==e[a].albumName)return e[a].coverImg}},watch:{},mounted(){window.addEventListener("scroll",this.handleScroll),this.authorId=this.data.split("_")[0],this.albumName=this.data.split("_")[1],this.queryData.authorId=this.authorId,this.queryData.albumName=this.albumName,v.get("init/getImagesByAlbum",this.queryData).then(e=>{e.code==200&&(e.data.forEach(s=>{s.ok=!1,s.simplifyImg=f+s.simplifyImg,this.images.push(s),this.originalImg.push(f+s.originalImg)}),setTimeout(()=>{let s=this.images.length,a=s-e.data.length;for(a;a<s;a++)this.images[a].ok=!0},100),e.data.length<this.queryData.pageSize&&(this.endmsg="\u6CA1\u6709\u66F4\u591A\u4E86...",window.removeEventListener("scroll",this.handleScroll)),this.queryData.startPage=this.queryData.startPage+4,this.queryData.pageSize=8)})},unmounted(){window.removeEventListener("scroll",this.handleScroll)}},G=e=>(H("data-v-e98604d8"),e=e(),R(),e),J={class:"illustration"},K={class:"ArticleInfo"},Q={style:{margin:"20px",color:"rgb(9, 214, 180)","font-size":"100px"}},W=G(()=>c("span",{style:{color:"#06a0e9","font-size":"30px"}}," \u76F8\u518C ",-1)),X={style:{margin:"0 0 1% 2.5%",height:"30px",opacity:"0.7"}},Y={key:0,style:{margin:"0 0 1% 1%",height:"30px",opacity:"0.7"}},Z=["onClick"],$=["onClick"],ee={class:"endmsg"};function te(e,s,a,n,l,o){const k=M,S=D("router-link"),I=U,g=T,y=O,E=D("CircleCheckFilled"),C=z;return m(),u("div",null,[t(_,{name:"el-fade-in"},{default:i(()=>[c("div",J,[t(k,{fit:"cover",class:"img",src:o.coverImg,alt:""},null,8,["src"]),c("div",K,[c("h1",Q,A(l.albumName),1),t(S,{to:"/Album/"+l.authorId},{default:i(()=>[W]),_:1},8,["to"])])])]),_:1}),t(y,{style:{"margin-top":"30px"}},{default:i(()=>[t(I,{class:"space"}),t(I,{class:"container"},{default:i(()=>[t(y,null,{default:i(()=>[c("div",X,[o.showFlag?(m(),L(g,{key:0,type:"primary",onClick:o.management},{default:i(()=>[p("\u7BA1\u7406")]),_:1},8,["onClick"])):F("",!0)]),t(_,{name:"el-zoom-in-top"},{default:i(()=>[l.editFlag?(m(),u("div",Y,[t(g,{type:"warning",onClick:o.moveImage},{default:i(()=>[p("\u79FB\u52A8")]),_:1},8,["onClick"]),t(g,{type:"danger",onClick:o.deleteImage},{default:i(()=>[p("\u5220\u9664")]),_:1},8,["onClick"]),t(g,{type:"success",onClick:o.selectAll},{default:i(()=>[p("\u5168\u9009")]),_:1},8,["onClick"])])):F("",!0)]),_:1})]),_:1}),t(y,{class:"body"},{default:i(()=>[(m(!0),u(P,null,V(l.images,(r,w)=>(m(),u("div",{class:"item",key:w},[h(c("div",{onClick:x=>o.selectImage(r)},[h(t(C,{class:"selectIcon"},{default:i(()=>[t(E)]),_:2},1536),[[d,!r.select]]),h(t(C,{class:"selectIcon1"},{default:i(()=>[t(E)]),_:2},1536),[[d,r.select]])],8,Z),[[d,l.editFlag]]),t(_,{name:"el-zoom-in-top"},{default:i(()=>[h(c("div",{class:"photoCloak",onClick:x=>o.selectImage(r)},null,8,$),[[d,l.editFlag]])]),_:2},1024),t(_,{name:"el-zoom-in-top"},{default:i(()=>[h(t(k,{class:"photo",src:r.simplifyImg,"preview-src-list":l.originalImg,fit:"cover","initial-index":w,"preview-teleported":!0,"hide-on-click-modal":!0},null,8,["src","preview-src-list","initial-index"]),[[d,r.ok]])]),_:2},1024)]))),128))]),_:1})]),_:1}),t(I,{class:"space"})]),_:1}),c("div",ee,A(l.endmsg),1)])}const ie=q(j,[["render",te],["__scopeId","data-v-e98604d8"]]);export{ie as default};
