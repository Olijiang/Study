import{ba as I,bb as v,bd as b,bi as H,bk as E,K as p,W as _,X as i,N as d,V as w,P as r,as as g,bh as h,Y as y,aT as T,L as S,a6 as z,bl as N,bm as V}from"./index.8b7c51ba.js";import{m as A,E as L}from"./markdown.4b399821.js";const B={components:{backToTop:v},props:{},data(){return{headings:[],curHeading:"",articleHtml:"",article:{title:"",category:"",tag:[],content:"",img:""},tocContent:"",tocId:[],tocTop:20,timeout:null,lastTag:null,scrollTag:!1}},methods:{detecator(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{let s=document.documentElement.scrollTop||document.body.scrollTop;this.tocId.forEach(c=>{document.querySelector(c).offsetTop+620-s<=10&&(this.lastTag=c,this.scrollTag=!0)}),s<600&&(this.lastTag=this.tocId[0])},100)},jump(s){document.querySelector(s).scrollIntoView({behavior:"smooth"}),this.lastTag=s,console.log("jump",s),this.scrollTag=!1},generateToc(){let s=/<h[1-3]>(.{0,50})<\/h[1-3]>/g,c=this.articleHtml.match(s),t=[],e=0;for(let l=0;l<c.length;l++){let o=c[l];if(t[e]==null){t[e]={},t[e].level=e+1,t[e].tag=o,t[e].text=o.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),t[e].children=[],t[e].href="#hool"+t[e].level,c[l]=o.substring(0,3)+" id='hool"+t[e].level+"'"+o.substring(3),this.articleHtml=this.articleHtml.replace(o,c[l]),this.tocId.push(t[e].href);continue}if(o[2]>t[e].tag[2]){let a={};a.level=t[e].level+"."+(t[e].children.length+1),a.tag=o,a.text=o.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),a.href="#hool"+t[e].level+"_"+(t[e].children.length+1),t[e].children.push(a),c[l]=o.substring(0,3)+" id='hool"+a.level.replace(".","_")+"'"+o.substring(3),this.articleHtml=this.articleHtml.replace(o,c[l]),this.tocId.push(a.href)}else e++,l--}this.tocContent=t}},computed:{},watch:{lastTag:{handler(s,c){let t=document.getElementById("toc"),e=document.documentElement.scrollHeight,l=document.documentElement.scrollTop;this.scrollTag&&(t.scrollTop=l/e*t.scrollHeight-200),this.tocId.forEach(o=>{let n=document.querySelector(o+"f");o==s?(n.style.backgroundColor="#b2fffe",n.style.color="#0400ff"):(n.style.backgroundColor="",n.style.color="")})}}},mounted(){let s={ArticleId:this.$route.path.split("/")[2]};b.get("init/getArticle",s).then(c=>{this.article=c.data,this.article.img=this.article.img,this.article.tag=JSON.parse(this.article.tag).tags;let t={fileName:this.article.content.split("\\")[1]};b.get("init/getContent",t).then(e=>{e.code==200&&(this.articleHtml=A(e.data),this.generateToc(),setTimeout(()=>{this.lastTag=this.tocId[0],window.addEventListener("scroll",this.detecator)},200))})})},unmounted(){window.removeEventListener("scroll",this.detecator)}},j=s=>(N("data-v-bd199e6a"),s=s(),V(),s),q={class:"illustration"},D=["src"],M={class:"ArticleInfo"},P={style:{margin:"20px",color:"rgb(9, 214, 180)","font-size":"50px"}},F={style:{margin:"10px"}},J={style:{margin:"10px"}},K=["innerHTML"],O={id:"toc",class:"articleCatelog"},R=j(()=>r("h3",null,"\u76EE \u5F55",-1)),W=["id","onClick"],X={key:0},Y=["onClick","id"];function G(s,c,t,e,l,o){const n=L,a=H,x=E,k=v;return p(),_("div",null,[i(w,{name:"el-fade-in"},{default:d(()=>[r("div",q,[r("img",{src:l.article.img,alt:""},null,8,D),r("div",M,[r("h1",P,g(l.article.title),1),r("p",F,[i(n,{type:"success",style:{"font-size":"15px"}},{default:d(()=>[h(" \u521B\u4F5C\u65F6\u95F4 ")]),_:1}),h(": "),i(n,{type:"danger",style:{"font-size":"15px"}},{default:d(()=>[h(g(l.article.createTime),1)]),_:1})]),r("p",J,[i(n,{type:"success",style:{"font-size":"15px"}},{default:d(()=>[h(" \u5206\u7C7B ")]),_:1}),h(": "),i(n,{type:"danger",style:{"font-size":"15px"}},{default:d(()=>[h(g(l.article.category),1)]),_:1}),i(n,{type:"success",style:{"font-size":"15px","margin-left":"20px"}},{default:d(()=>[h(" \u6807\u7B7E ")]),_:1}),h(": "),(p(!0),_(y,null,T(l.article.tag,(u,f)=>(p(),S(n,{type:"danger",style:{"font-size":"15px","margin-right":"10px"},key:f},{default:d(()=>[h(g(u),1)]),_:2},1024))),128))])])])]),_:1}),i(x,null,{default:d(()=>[i(a,{class:"vacancy"}),i(a,{class:"space"}),i(a,{class:"articleCol"},{default:d(()=>[r("div",{class:"markdown-body",innerHTML:l.articleHtml},null,8,K)]),_:1}),i(a,{class:"space"}),i(a,{class:"catelogCol"},{default:d(()=>[r("div",O,[R,r("ol",null,[(p(!0),_(y,null,T(l.tocContent,(u,f)=>(p(),_("li",{key:f},[r("span",{class:"toc_item",id:u.href.substring(1)+"f",onClick:m=>o.jump(u.href)},g(u.level)+". "+g(u.text),9,W),u.children.length!=0?(p(),_("ol",X,[(p(!0),_(y,null,T(u.children,(m,C)=>(p(),_("li",{key:C,style:{"padding-left":"20px"}},[r("span",{class:"toc_item",onClick:Q=>o.jump(m.href),id:m.href.substring(1)+"f"},g(m.level)+". "+g(m.text),9,Y)]))),128))])):z("",!0)]))),128))])])]),_:1})]),_:1}),i(k)])}const $=I(B,[["render",G],["__scopeId","data-v-bd199e6a"]]);export{$ as default};
