import{_ as p,A as V}from"./index.7f3d917a.js";import{m as g}from"./markdown.fab8dcaa.js";import"vue";const _={components:{},props:["articleId"],data(){return{headings:[],curHeading:"",articleHtml:"",article:{title:"",category:"",tag:[],content:"",img:""},tocContent:"",tocId:[],tocTop:20,timeout:null,lastTag:null,scrollTag:!1,ok:!1}},methods:{detecator(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{let o=document.documentElement.scrollTop||document.body.scrollTop;this.tocId.forEach(i=>{document.querySelector(i).offsetTop+620-o<=10&&(this.lastTag=i,this.scrollTag=!0)}),o<600&&(this.lastTag=this.tocId[0])},100)},jump(o){document.querySelector(o).scrollIntoView({behavior:"smooth"}),this.lastTag=o,console.log("jump",o),this.scrollTag=!1},generateToc(){let o=/<h[1-3]>(.{0,50})<\/h[1-3]>/g,i=this.articleHtml.match(o),e=[],t=0;for(let l=0;l<i.length;l++){let c=i[l];if(e[t]==null){e[t]={},e[t].level=t+1,e[t].tag=c,e[t].text=c.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),e[t].children=[],e[t].href="#hool"+e[t].level,i[l]=c.substring(0,3)+" id='hool"+e[t].level+"'"+c.substring(3),this.articleHtml=this.articleHtml.replace(c,i[l]),this.tocId.push(e[t].href);continue}if(c[2]>e[t].tag[2]){let r={};r.level=e[t].level+"."+(e[t].children.length+1),r.tag=c,r.text=c.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),r.href="#hool"+e[t].level+"_"+(e[t].children.length+1),e[t].children.push(r),i[l]=c.substring(0,3)+" id='hool"+r.level.replace(".","_")+"'"+c.substring(3),this.articleHtml=this.articleHtml.replace(c,i[l]),this.tocId.push(r.href)}else t++,l--}this.tocContent=e}},computed:{},watch:{lastTag:{handler(o,i){let e=document.getElementById("toc"),t=document.documentElement.scrollHeight,l=document.documentElement.scrollTop;this.scrollTag&&(e.scrollTop=l/t*e.scrollHeight-200),this.tocId.forEach(c=>{let s=document.querySelector(c+"f");c==o?(s.style.backgroundColor="#b2fffe",s.style.color="#0400ff"):(s.style.backgroundColor="",s.style.color="")})}}},mounted(){let o={ArticleId:this.articleId};V.get("init/getArticle",o).then(i=>{this.article=i.data,this.article.img=this.baseUrl+this.article.img,this.article.tag=JSON.parse(this.article.tag).tags;let e={filePath:this.article.content};V.get("init/getContent",e).then(t=>{t.code==200&&(this.articleHtml=g(t.data),this.generateToc(),this.ok=!0,setTimeout(()=>{this.lastTag=this.tocId[0],window.addEventListener("scroll",this.detecator)},200))})})},unmounted(){window.removeEventListener("scroll",this.detecator)}},f=o=>(Vue.pushScopeId("data-v-e81d6779"),o=o(),Vue.popScopeId(),o),x={class:"illustration"},y={class:"ArticleInfo"},N={style:{margin:"20px",color:"rgb(9, 214, 180)","font-size":"50px"}},T={style:{margin:"10px"}},v={style:{margin:"10px"}},k=["innerHTML"],C={id:"toc",class:"articleCatelog"},w=f(()=>Vue.createElementVNode("h3",null,"\u76EE \u5F55",-1)),E=["id","onClick"],I={key:0},B=["onClick","id"];function S(o,i,e,t,l,c){const s=Vue.resolveComponent("el-image"),r=Vue.resolveComponent("el-tag"),a=Vue.resolveComponent("el-col"),h=Vue.resolveComponent("el-row");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(Vue.Transition,{name:"el-fade-in"},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",x,[Vue.createVNode(s,{fit:"cover",class:"img",src:l.article.img,alt:""},null,8,["src"]),Vue.createElementVNode("div",y,[Vue.createElementVNode("h1",N,Vue.toDisplayString(l.article.title),1),Vue.createElementVNode("p",T,[Vue.createVNode(r,{type:"success",style:{"font-size":"15px"}},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u521B\u4F5C\u65F6\u95F4 ")]),_:1}),Vue.createTextVNode(": "),Vue.createVNode(r,{type:"danger",style:{"font-size":"15px"}},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(l.article.createTime),1)]),_:1})]),Vue.createElementVNode("p",v,[Vue.createVNode(r,{type:"success",style:{"font-size":"15px"}},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u5206\u7C7B ")]),_:1}),Vue.createTextVNode(": "),Vue.createVNode(r,{type:"danger",style:{"font-size":"15px"}},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(l.article.category),1)]),_:1}),Vue.createVNode(r,{type:"success",style:{"font-size":"15px","margin-left":"20px"}},{default:Vue.withCtx(()=>[Vue.createTextVNode(" \u6807\u7B7E ")]),_:1}),Vue.createTextVNode(": "),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(l.article.tag,(n,d)=>(Vue.openBlock(),Vue.createBlock(r,{type:"danger",style:{"font-size":"15px","margin-right":"10px"},key:d},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(n),1)]),_:2},1024))),128))])])])]),_:1}),Vue.createVNode(h,null,{default:Vue.withCtx(()=>[Vue.createVNode(a,{class:"vacancy"}),Vue.createVNode(a,{class:"space"}),Vue.createVNode(a,{class:"articleCol"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.Transition,{name:"el-zoom-in-top"},{default:Vue.withCtx(()=>[Vue.withDirectives(Vue.createElementVNode("div",{class:"markdown-body",innerHTML:l.articleHtml},null,8,k),[[Vue.vShow,l.ok]])]),_:1})]),_:1}),Vue.createVNode(a,{class:"space"}),Vue.createVNode(a,{class:"catelogCol"},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.Transition,{name:"el-zoom-in-top"},{default:Vue.withCtx(()=>[Vue.withDirectives(Vue.createElementVNode("div",C,[w,Vue.createElementVNode("ol",null,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(l.tocContent,(n,d)=>(Vue.openBlock(),Vue.createElementBlock("li",{key:d},[Vue.createElementVNode("span",{class:"toc_item",id:n.href.substring(1)+"f",onClick:u=>c.jump(n.href)},Vue.toDisplayString(n.level)+". "+Vue.toDisplayString(n.text),9,E),n.children.length!=0?(Vue.openBlock(),Vue.createElementBlock("ol",I,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(n.children,(u,m)=>(Vue.openBlock(),Vue.createElementBlock("li",{key:m,style:{"padding-left":"20px"}},[Vue.createElementVNode("span",{class:"toc_item",onClick:b=>c.jump(u.href),id:u.href.substring(1)+"f"},Vue.toDisplayString(u.level)+". "+Vue.toDisplayString(u.text),9,B)]))),128))])):Vue.createCommentVNode("",!0)]))),128))])],512),[[Vue.vShow,l.ok]])]),_:1})]),_:1})]),_:1})])}const A=p(_,[["render",S],["__scopeId","data-v-e81d6779"]]);export{A as default};
