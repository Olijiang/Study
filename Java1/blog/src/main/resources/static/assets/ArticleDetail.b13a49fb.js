import{_ as E,a as w,A as x,l as z,n as S,o as p,g as m,e as c,w as r,T as y,f as d,t as g,j as h,F as T,h as v,d as A,ac as k,af as b,q as j,s as N,u as V}from"./index.8ad34794.js";import{E as B}from"./el-tag.f224c1ec.js";import{m as L}from"./markdown.fab8dcaa.js";const q={components:{backToTop:w},props:{},data(){return{headings:[],curHeading:"",articleHtml:"",article:{title:"",category:"",tag:[],content:"",img:""},tocContent:"",tocId:[],tocTop:20,timeout:null,lastTag:null,scrollTag:!1,ok:!1}},methods:{detecator(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{let o=document.documentElement.scrollTop||document.body.scrollTop;this.tocId.forEach(i=>{document.querySelector(i).offsetTop+620-o<=10&&(this.lastTag=i,this.scrollTag=!0)}),o<600&&(this.lastTag=this.tocId[0])},100)},jump(o){document.querySelector(o).scrollIntoView({behavior:"smooth"}),this.lastTag=o,console.log("jump",o),this.scrollTag=!1},generateToc(){let o=/<h[1-3]>(.{0,50})<\/h[1-3]>/g,i=this.articleHtml.match(o),t=[],e=0;for(let l=0;l<i.length;l++){let s=i[l];if(t[e]==null){t[e]={},t[e].level=e+1,t[e].tag=s,t[e].text=s.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),t[e].children=[],t[e].href="#hool"+t[e].level,i[l]=s.substring(0,3)+" id='hool"+t[e].level+"'"+s.substring(3),this.articleHtml=this.articleHtml.replace(s,i[l]),this.tocId.push(t[e].href);continue}if(s[2]>t[e].tag[2]){let a={};a.level=t[e].level+"."+(t[e].children.length+1),a.tag=s,a.text=s.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),a.href="#hool"+t[e].level+"_"+(t[e].children.length+1),t[e].children.push(a),i[l]=s.substring(0,3)+" id='hool"+a.level.replace(".","_")+"'"+s.substring(3),this.articleHtml=this.articleHtml.replace(s,i[l]),this.tocId.push(a.href)}else e++,l--}this.tocContent=t}},computed:{},watch:{lastTag:{handler(o,i){let t=document.getElementById("toc"),e=document.documentElement.scrollHeight,l=document.documentElement.scrollTop;this.scrollTag&&(t.scrollTop=l/e*t.scrollHeight-200),this.tocId.forEach(s=>{let n=document.querySelector(s+"f");s==o?(n.style.backgroundColor="#b2fffe",n.style.color="#0400ff"):(n.style.backgroundColor="",n.style.color="")})}}},mounted(){let o={ArticleId:this.$route.path.split("/")[2]};x.get("init/getArticle",o).then(i=>{this.article=i.data,this.article.img=this.article.img,this.article.tag=JSON.parse(this.article.tag).tags;let t={fileName:this.article.content.split("\\")[1]};x.get("init/getContent",t).then(e=>{e.code==200&&(this.articleHtml=L(e.data),this.generateToc(),this.ok=!0,setTimeout(()=>{this.lastTag=this.tocId[0],window.addEventListener("scroll",this.detecator)},200))})})},unmounted(){window.removeEventListener("scroll",this.detecator)}},D=o=>(N("data-v-47676171"),o=o(),V(),o),F={class:"illustration"},M=["src"],J={class:"ArticleInfo"},O={style:{margin:"20px",color:"rgb(9, 214, 180)","font-size":"50px"}},P={style:{margin:"10px"}},R={style:{margin:"10px"}},G=["innerHTML"],K={id:"toc",class:"articleCatelog"},Q=D(()=>d("h3",null,"\u76EE \u5F55",-1)),U=["id","onClick"],W={key:0},X=["onClick","id"];function Y(o,i,t,e,l,s){const n=B,a=z,C=S,I=w;return p(),m("div",null,[c(y,{name:"el-fade-in"},{default:r(()=>[d("div",F,[d("img",{src:l.article.img,onerror:"javascript:this.src='src/img/imgslot.webp'"},null,8,M),d("div",J,[d("h1",O,g(l.article.title),1),d("p",P,[c(n,{type:"success",style:{"font-size":"15px"}},{default:r(()=>[h(" \u521B\u4F5C\u65F6\u95F4 ")]),_:1}),h(": "),c(n,{type:"danger",style:{"font-size":"15px"}},{default:r(()=>[h(g(l.article.createTime),1)]),_:1})]),d("p",R,[c(n,{type:"success",style:{"font-size":"15px"}},{default:r(()=>[h(" \u5206\u7C7B ")]),_:1}),h(": "),c(n,{type:"danger",style:{"font-size":"15px"}},{default:r(()=>[h(g(l.article.category),1)]),_:1}),c(n,{type:"success",style:{"font-size":"15px","margin-left":"20px"}},{default:r(()=>[h(" \u6807\u7B7E ")]),_:1}),h(": "),(p(!0),m(T,null,v(l.article.tag,(u,f)=>(p(),A(n,{type:"danger",style:{"font-size":"15px","margin-right":"10px"},key:f},{default:r(()=>[h(g(u),1)]),_:2},1024))),128))])])])]),_:1}),c(C,null,{default:r(()=>[c(a,{class:"vacancy"}),c(a,{class:"space"}),c(a,{class:"articleCol"},{default:r(()=>[c(y,{name:"el-zoom-in-top"},{default:r(()=>[k(d("div",{class:"markdown-body",innerHTML:l.articleHtml},null,8,G),[[b,l.ok]])]),_:1})]),_:1}),c(a,{class:"space"}),c(a,{class:"catelogCol"},{default:r(()=>[c(y,{name:"el-zoom-in-top"},{default:r(()=>[k(d("div",K,[Q,d("ol",null,[(p(!0),m(T,null,v(l.tocContent,(u,f)=>(p(),m("li",{key:f},[d("span",{class:"toc_item",id:u.href.substring(1)+"f",onClick:_=>s.jump(u.href)},g(u.level)+". "+g(u.text),9,U),u.children.length!=0?(p(),m("ol",W,[(p(!0),m(T,null,v(u.children,(_,H)=>(p(),m("li",{key:H,style:{"padding-left":"20px"}},[d("span",{class:"toc_item",onClick:Z=>s.jump(_.href),id:_.href.substring(1)+"f"},g(_.level)+". "+g(_.text),9,X)]))),128))])):j("",!0)]))),128))])],512),[[b,l.ok]])]),_:1})]),_:1})]),_:1}),c(I)])}const lt=E(q,[["render",Y],["__scopeId","data-v-47676171"]]);export{lt as default};
