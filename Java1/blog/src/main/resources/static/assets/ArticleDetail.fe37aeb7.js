import{_ as w,A as k,o as u,e as g,f as c,w as n,T,g as r,t as p,i as d,F as v,k as x,h as H,l as E,v as I,j as S,p as z,m as A}from"./index.f39f917a.js";import{E as V,a as B,b as D}from"./el-image-viewer.041a35b8.js";import{E as L}from"./el-tag.66f612cb.js";import{m as j}from"./markdown.fab8dcaa.js";const N={components:{},props:["articleId"],data(){return{headings:[],curHeading:"",articleHtml:"",article:{title:"",category:"",tag:[],content:"",img:""},tocContent:"",tocId:[],tocTop:20,timeout:null,lastTag:null,scrollTag:!1,ok:!1}},methods:{detecator(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{let o=document.documentElement.scrollTop||document.body.scrollTop;this.tocId.forEach(a=>{document.querySelector(a).offsetTop+620-o<=10&&(this.lastTag=a,this.scrollTag=!0)}),o<600&&(this.lastTag=this.tocId[0])},100)},jump(o){document.querySelector(o).scrollIntoView({behavior:"smooth"}),this.lastTag=o,console.log("jump",o),this.scrollTag=!1},generateToc(){let o=/<h[1-3]>(.{0,50})<\/h[1-3]>/g,a=this.articleHtml.match(o),e=[],t=0;for(let l=0;l<a.length;l++){let s=a[l];if(e[t]==null){e[t]={},e[t].level=t+1,e[t].tag=s,e[t].text=s.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),e[t].children=[],e[t].href="#hool"+e[t].level,a[l]=s.substring(0,3)+" id='hool"+e[t].level+"'"+s.substring(3),this.articleHtml=this.articleHtml.replace(s,a[l]),this.tocId.push(e[t].href);continue}if(s[2]>e[t].tag[2]){let i={};i.level=e[t].level+"."+(e[t].children.length+1),i.tag=s,i.text=s.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),i.href="#hool"+e[t].level+"_"+(e[t].children.length+1),e[t].children.push(i),a[l]=s.substring(0,3)+" id='hool"+i.level.replace(".","_")+"'"+s.substring(3),this.articleHtml=this.articleHtml.replace(s,a[l]),this.tocId.push(i.href)}else t++,l--}this.tocContent=e}},computed:{},watch:{lastTag:{handler(o,a){let e=document.getElementById("toc"),t=document.documentElement.scrollHeight,l=document.documentElement.scrollTop;this.scrollTag&&(e.scrollTop=l/t*e.scrollHeight-200),this.tocId.forEach(s=>{let m=document.querySelector(s+"f");s==o?(m.style.backgroundColor="#b2fffe",m.style.color="#0400ff"):(m.style.backgroundColor="",m.style.color="")})}}},mounted(){let o={ArticleId:this.articleId};k.get("init/getArticle",o).then(a=>{this.article=a.data,this.article.img={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}.VITE_BASE_URL+this.article.img,this.article.tag=JSON.parse(this.article.tag).tags;let e={filePath:this.article.content};k.get("init/getContent",e).then(t=>{t.code==200&&(this.articleHtml=j(t.data),this.generateToc(),this.ok=!0,setTimeout(()=>{this.lastTag=this.tocId[0],window.addEventListener("scroll",this.detecator)},200))})})},unmounted(){window.removeEventListener("scroll",this.detecator)}},R=o=>(z("data-v-9f22abe7"),o=o(),A(),o),q={class:"illustration"},M={class:"ArticleInfo"},O={style:{margin:"20px",color:"rgb(9, 214, 180)","font-size":"50px"}},P={style:{margin:"10px"}},F={style:{margin:"10px"}},U=["innerHTML"],J={id:"toc",class:"articleCatelog"},G=R(()=>r("h3",null,"\u76EE \u5F55",-1)),K=["id","onClick"],Q={key:0},W=["onClick","id"];function X(o,a,e,t,l,s){const m=V,i=L,_=B,b=D;return u(),g("div",null,[c(T,{name:"el-fade-in"},{default:n(()=>[r("div",q,[c(m,{fit:"cover",class:"img",src:l.article.img,alt:""},null,8,["src"]),r("div",M,[r("h1",O,p(l.article.title),1),r("p",P,[c(i,{type:"success",style:{"font-size":"15px"}},{default:n(()=>[d(" \u521B\u4F5C\u65F6\u95F4 ")]),_:1}),d(": "),c(i,{type:"danger",style:{"font-size":"15px"}},{default:n(()=>[d(p(l.article.createTime),1)]),_:1})]),r("p",F,[c(i,{type:"success",style:{"font-size":"15px"}},{default:n(()=>[d(" \u5206\u7C7B ")]),_:1}),d(": "),c(i,{type:"danger",style:{"font-size":"15px"}},{default:n(()=>[d(p(l.article.category),1)]),_:1}),c(i,{type:"success",style:{"font-size":"15px","margin-left":"20px"}},{default:n(()=>[d(" \u6807\u7B7E ")]),_:1}),d(": "),(u(!0),g(v,null,x(l.article.tag,(h,y)=>(u(),H(i,{type:"danger",style:{"font-size":"15px","margin-right":"10px"},key:y},{default:n(()=>[d(p(h),1)]),_:2},1024))),128))])])])]),_:1}),c(b,null,{default:n(()=>[c(_,{class:"vacancy"}),c(_,{class:"space"}),c(_,{class:"articleCol"},{default:n(()=>[c(T,{name:"el-zoom-in-top"},{default:n(()=>[E(r("div",{class:"markdown-body",innerHTML:l.articleHtml},null,8,U),[[I,l.ok]])]),_:1})]),_:1}),c(_,{class:"space"}),c(_,{class:"catelogCol"},{default:n(()=>[c(T,{name:"el-zoom-in-top"},{default:n(()=>[E(r("div",J,[G,r("ol",null,[(u(!0),g(v,null,x(l.tocContent,(h,y)=>(u(),g("li",{key:y},[r("span",{class:"toc_item",id:h.href.substring(1)+"f",onClick:f=>s.jump(h.href)},p(h.level)+". "+p(h.text),9,K),h.children.length!=0?(u(),g("ol",Q,[(u(!0),g(v,null,x(h.children,(f,C)=>(u(),g("li",{key:C,style:{"padding-left":"20px"}},[r("span",{class:"toc_item",onClick:Y=>s.jump(f.href),id:f.href.substring(1)+"f"},p(f.level)+". "+p(f.text),9,W)]))),128))])):S("",!0)]))),128))])],512),[[I,l.ok]])]),_:1})]),_:1})]),_:1})])}const le=w(N,[["render",X],["__scopeId","data-v-9f22abe7"]]);export{le as default};
